<div class="container">
    <div class="row mt-5">
        <div class="col-sm-5 dogPhotos"></div>
        <div class="col-sm-7 dogInfo"></div>
    </div>
</div>

{{> form}}

<script>
    $(function () {

        console.log(`{{dogJson._id}}`);

        // Make dog carousel
        function renderDogCarousel(dogJson) {
            let imgs = dogJson.photos.map((img, i) => {
                if (i == 0) {
                    return `<div class="carousel-item active">
                        <img src="data:image ;base64, ${img}" alt="dog image" />
                    </div>`

                } else {
                    return `<div class="carousel-item">
                        <img src="data:image ;base64, ${img}" alt="dog image" />
                    </div>`
                }
            })

            let thumbnail = dogJson.photos.map((img, i) => {
                if (i == 0) {
                    return `<button data-target="#${dogJson._id}" data-slide-to="0" class="active thumbnail"><img src="data:image ;base64, ${img}" alt="dog image"/></button>`
                } else {
                    return `<button data-target="#${dogJson._id}" class="thumbnail" data-slide-to="${i}" ><img src="data:image ;base64, ${img}" alt="dog image" /></button>`
                }
            })

            let s = `<div id="${dogJson._id}" class="carousel slide">
                                <div class="carousel-inner">
                                    ${imgs.join("")}
                                </div>
                                </div>
                                <div class="mt-3 d-flex justify-content-center">
                                    ${thumbnail.join("")}
                                </div>
                            </div>`
            return s
        }

        // Get dog information
        $.get("/dog" + window.location.pathname).done(dogJson => {
            $('.dogPhotos').html(renderDogCarousel(dogJson));

            $('.dogInfo').html(`
                <div class="ml-5">
                    <h1 id="dogName">${dogJson.name}</h1>
                    <table class="mt-4">
                        <tbody>
                            <tr>
                                <td>Breed</td>
                                <td id="dogBreed">${dogJson.breed}</td>
                            </tr>
                            <tr>
                                <td>Sex</td>
                                <td id="dogSex">${dogJson.sex}</td>
                            </tr>
                            <tr>
                                <td>Age</td>
                                <td id="dogAge">${dogJson.age}</td>
                            </tr>
                            <tr>
                                <td>Size</td>
                                <td id="dogSize">${dogJson.size}</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="owner-control mt-4">
                        <h5>Manage your dog</h5>
                        <i class="fa fa-pencil fa-2x" data-toggle="modal" data-target="#formDogModal" aria-hidden="true"></i>
                        <i class="fa fa-trash fa-2x" data-toggle="modal" data-target="#deleteDogModal" aria-hidden="true"></i>
                    </div>
                </div>`);
            
            $('.container').append(`
                <div class="mt-5">
                    <h3>Description</h3>
                    <p id="dogDescription">${dogJson.description.replace(/\n/g, '<br>')}</p>
                </div>
                <div class="mt-5">
                    <h3>Reviews</h3>
                    <p>${dogJson.reviews}</p>
                </div>
                `);
        })

    }) 
</script>

<script src="/js/updateDog.js"></script>